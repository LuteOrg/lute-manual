<!DOCTYPE HTML>
<html lang="en" class="rust" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Command line jobs - Lute manual</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../css/custom.css">

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "rust";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('rust')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item affix "><a href="../intro.html">Introduction</a></li><li class="chapter-item "><a href="../background.html">Background</a></li><li class="chapter-item affix "><li class="part-title">Installation</li><li class="chapter-item "><a href="../install/install.html">Installation</a></li><li class="chapter-item "><a href="../install/windows/index.html">Installing on Windows</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../install/windows/windows-10-32-bit-using-python.html">Windows 10 (32 bit) using Python and pip</a></li><li class="chapter-item "><a href="../install/windows/windows-using-docker.html">Windows using Docker</a></li></ol></li><li class="chapter-item "><a href="../install/mecab.html">MeCab for Japanese</a></li><li class="chapter-item "><a href="../install/plugins.html">Language parser plugins</a></li><li class="chapter-item "><a href="../install/troubleshooting.html">Troubleshooting</a></li><li class="chapter-item "><a href="../install/beta-releases.html">Beta releases</a></li><li class="chapter-item affix "><li class="part-title">Usage</li><li class="chapter-item "><a href="../usage/starting-and-stopping.html">Starting and stopping</a></li><li class="chapter-item "><div>Languages</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../usage/languages/defining-languages.html">Defining a language</a></li><li class="chapter-item "><a href="../usage/languages/dictionaries.html">Dictionaries</a></li><li class="chapter-item "><a href="../usage/languages/word-characters.html">Word characters</a></li></ol></li><li class="chapter-item "><div>Books</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../usage/books/creating-books.html">Creating books</a></li><li class="chapter-item "><a href="../usage/books/stats.html">The stats calculation</a></li></ol></li><li class="chapter-item "><div>Reading</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../usage/reading/reading.html">Reading</a></li><li class="chapter-item "><a href="../usage/keyboard-bindings.html">Key bindings</a></li><li class="chapter-item "><a href="../usage/reading-on-mobile.html">Reading on mobile</a></li><li class="chapter-item "><a href="../usage/reading/overlapping-terms.html">Overlapping terms</a></li><li class="chapter-item "><a href="../usage/reading/tutorial.html">The demo tutorial</a></li></ol></li><li class="chapter-item "><div>Terms</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../usage/terms/terms.html">Terms</a></li><li class="chapter-item "><a href="../usage/terms/parent-terms.html">Parent terms</a></li><li class="chapter-item "><a href="../usage/terms/link-parent-child-statuses.html">Linking parent-child statuses</a></li><li class="chapter-item "><a href="../usage/terms/bulk-term-import.html">Bulk term import</a></li></ol></li><li class="chapter-item "><div>Themes</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../usage/themes/themes.html">Themes</a></li><li class="chapter-item "><a href="../usage/themes/toggling-highlights.html">Toggling highlights</a></li><li class="chapter-item "><a href="../usage/themes/custom-styles.html">Custom styles</a></li></ol></li><li class="chapter-item "><a href="../usage/audio.html">Adding audio</a></li><li class="chapter-item "><a href="../backup/backup.html">Backup</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../backup/restore.html">Restoring backups</a></li></ol></li><li class="chapter-item expanded "><a href="../usage/command-line-jobs.html" class="active">Command line jobs</a></li><li class="chapter-item "><a href="../usage/updating.html">Updating Lute</a></li><li class="chapter-item affix "><li class="part-title">FAQs</li><li class="chapter-item "><a href="../faq/help.html">Where can I get help?</a></li><li class="chapter-item "><div>Setup</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../faq/setup/web-server.html">Can I run Lute on a private web server?</a></li><li class="chapter-item "><a href="../faq/setup/mobile-support.html">Can I run Lute on my phone or pad?</a></li><li class="chapter-item "><a href="../faq/setup/usb.html">Can I store Lute data on a USB key?</a></li><li class="chapter-item "><a href="../faq/setup/adding-basic-auth.html">Can I make Lute secure?</a></li><li class="chapter-item "><a href="../faq/setup/online-lute.html">Is there an online version of Lute?</a></li><li class="chapter-item "><a href="../faq/setup/v2-to-v3.html">How can I migrate from Lute v2 to v3?</a></li></ol></li><li class="chapter-item "><div>Languages</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../faq/language/add-a-language.html">Can you add language X?</a></li></ol></li><li class="chapter-item "><div>Books</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../faq/books/finding-stuff.html">Where can I find books to import?</a></li><li class="chapter-item "><a href="../faq/books/epub-import.html">Why won't my epub import correctly?</a></li><li class="chapter-item "><a href="../faq/books/pdf-import.html">Why won't my pdf import correctly?</a></li><li class="chapter-item "><a href="../faq/books/utf-8.html">My text file import is giving a "utf-8 encoding" error message</a></li></ol></li><li class="chapter-item "><div>Reading</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../faq/reading/click-not-working.html">I can't click on words in the reading screen</a></li></ol></li><li class="chapter-item "><div>Terms</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../faq/terms/terms-cannot-be-changed-once-created.html">Why can't I change a Term?</a></li><li class="chapter-item "><a href="../faq/terms/sentences-only-shown-when-page-is-read.html">Where are my new Term's sentences?</a></li><li class="chapter-item "><a href="../faq/terms/term-statuses.html">How should I use statuses?</a></li></ol></li><li class="chapter-item "><a href="../faq/import-from-other-systems.html">Can I import data from other systems?</a></li><li class="chapter-item "><a href="../faq/why-no-flashcards.html">Why doesn't Lute have flashcards, or an SRS?</a></li><li class="chapter-item "><a href="../faq/prioritizing-dev-work.html">How is development work prioritized?</a></li><li class="chapter-item "><a href="../faq/free.html">Why is this free?</a></li><li class="chapter-item affix "><li class="part-title">Misc</li><li class="chapter-item "><a href="../misc/changelog.html">Changelog</a></li><li class="chapter-item "><a href="../misc/backlog.html">Backlog</a></li><li class="chapter-item "><a href="../misc/doc-feedback.html">Documentation feedback</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Lute manual</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/LuteOrg/lute-manual/" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="command-line-jobs"><a class="header" href="#command-line-jobs">Command line jobs</a></h1>
<p>While Lute is almost solely a web app, it has some jobs that are run from the terminal, outside of the browser.</p>
<ul>
<li><code>hello</code>: Say hi!  Proof-of-concept</li>
<li><code>language_export</code>: Get all terms from active books in the language, and write a data file of term frequencies and children.</li>
</ul>
<h2 id="how-to-run-the-jobs"><a class="header" href="#how-to-run-the-jobs">How to run the jobs</a></h2>
<p><strong>These jobs are (currently) only runnable through the command line for pip installs.</strong></p>
<p>Open a terminal, change directory to your Lute folder, and enter the following commands:</p>
<pre><code>source .venv/bin/activate    # Activate your virtual environment.
flask --app lute.app_factory cli &lt;command_name&gt; [arg1] [arg2...]
</code></pre>
<p>The <code>--app lute.app_factory</code> part is <strong>required</strong><sup class="footnote-reference"><a href="#these-calls-are-ugly">1</a></sup>.</p>
<p>Lute does not need to be running when you're running a command.</p>
<p>List all jobs:</p>
<pre><code>flask --app lute.app_factory cli --help
</code></pre>
<p>To see help about a job:</p>
<pre><code>flask --app lute.app_factory cli &lt;command_name&gt; --help
</code></pre>
<h3 id="sample-calls"><a class="header" href="#sample-calls">Sample calls</a></h3>
<pre><code>flask --app lute.app_factory cli hello
flask --app lute.app_factory cli language_export Spanish sp_terms.csv
</code></pre>
<p>You can do things like <a href="https://flask.palletsprojects.com/en/2.3.x/cli/#environment-variables-from-dotenv">export environment variables</a> to simplify your calls if you wish.</p>
<h2 id="configyml-file"><a class="header" href="#configyml-file">config.yml file</a></h2>
<p>If you have a <a href="./starting-and-stopping.html#custom-configyml">custom config.yml</a>, Lute jobs will use those settings; otherwise, it uses the built-in defaults.</p>
<h2 id="why-arent-these-built-into-the-ui"><a class="header" href="#why-arent-these-built-into-the-ui">Why aren't these built into the UI?</a></h2>
<p>Good question, here are some reasons:</p>
<ul>
<li><strong>Unsure how to add to UI.</strong> Lute is primarily for reading, and I've tried to keep the UI clean and focused on that.  Some things are <em>related</em> to Lute but don't necessarily fall within its main purpose.</li>
<li><strong>Long-running jobs.</strong> Some jobs might take a <em>long</em> time to complete.  While there are ways to have the server communicate back to a browser client (WebSockets), I have no experience with these things.</li>
<li><strong>"Good enough" is better than perfect.</strong> Shipping something working is better than trying to perfect it.  Sometimes jobs are a hacky but effective way to get things out the door.</li>
</ul>
<h2 id="docker-users"><a class="header" href="#docker-users">Docker users</a></h2>
<p>You have a few ways to run command-line jobs, if your Lute runs in Docker.  Both are a bit janky, so pick your poison.  My preference would be the first one, just because you don't have to install anything new.</p>
<h3 id="1-ssh-into-the-running-docker-instance"><a class="header" href="#1-ssh-into-the-running-docker-instance">1. ssh into the running Docker instance</a></h3>
<p>If your container is running, you can jump into it and run commands.  For example:</p>
<pre><code>$ docker ps

CONTAINER ID   IMAGE                           COMMAND            CREATED          STATUS          PORTS                    NAMES
4a01240e5678   jzohrab/lute3:latest            "/lute/start.sh"   52 seconds ago   Up 52 seconds   0.0.0.0:5000-&gt;5000/tcp   lute_test_docker-lute-1

# Connect to the running container
$ docker exec -it lute_test_docker-lute-1 /bin/bash

# Run the export.  Put the file in the lute_data folder so it's available back on the host.
root@4a01240e5678:/# flask --app lute.app_factory cli language_export English ./lute_data/MY_DATA.csv
Loading data for book Tutorial ...
... etc ...

# Leave the container
root@4a01240e5678:/# exit

# Back on the host system!
$ ls data
README.md	MY_DATA.csv	lute.db		userimages
</code></pre>
<h3 id="2-with-pip"><a class="header" href="#2-with-pip">2. With pip</a></h3>
<ul>
<li>Install Lute into a virtual environment using pip</li>
<li>Create a config.yml file with the data folder pointing to where your lute.db is stored</li>
<li>Run the commands as above.</li>
</ul>
<hr />
<div class="footnote-definition" id="these-calls-are-ugly"><sup class="footnote-definition-label">1</sup>
<p><em>Note from the dev (me!):</em> I recognize how ugly the "--app lute.app_factory" portion of the command is, but it is not trivial to get rid of.  The commands are built on part of the framework that Lute uses, and there is no easy way to avoid the "--app" flag, as far as I know.  I tried other design options, but they all had drawbacks.  In future, these jobs may be incorporated into Lute's UI.  For now, this is good enough.</p>
</div>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../backup/restore.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../usage/updating.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../backup/restore.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../usage/updating.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
